<?xml version="1.0"?>
<configuration>
  <configSections>
    <section name="Sonar" type="Infragravity.Sonar.SonarConfigurationSection, Sonar"/>
  </configSections>
  <connectionStrings>
    <add name="perfmon" providerName="mspdh" connectionString="." />
    <add name="sonar" providerName="wsman" connectionString="Server=sonar;" />
	<add name="db" providerName="wsman" connectionString="Server=db;" />
	<add name="sqldb" providerName="mssql" connectionString="Server=L1648-DV2R2;Database='L1648-DV1'; User Id=sa-lab; Password=p@ssword1;Connection Timeout=20;" />
	<add name="sqldb_vrnsdomaindb" providerName="mssql" connectionString="Server=L1648-DV2R2;Database='VrnsDomainDB'; User Id=sa-lab; Password=p@ssword1;Connection Timeout=20;" />
  </connectionStrings>
  <Sonar>
    <Runtime scrapeIntervalSeconds="5" skipSSLCheck="true" threads="1"/>
	
    <InputAdapters>
      <add provider="wsman" type="Infragravity.Sonar.Adapters.WsMan.WsmanAdapterFactory,Sonar" />
      <add provider="mspdh" type="Infragravity.Sonar.Adapters.PerformanceCounter.PerfCounterAdapterFactory,Infragravity.Sonar.Adapters.PerformanceCounter" />
	  <add provider="mssql" type="Infragravity.Sonar.Adapters.SqlServer.SqlServerAdapterFactory,Infragravity.Sonar.Adapters.SqlServer" />
    </InputAdapters>
	
    <Servers>
        <add name="sonar" url="http://localhost:5985/wsman" username="" password="" timeoutMilliseconds="1000" authType="Negotiate"/>
		<add name="db" url="http://10.10.193.93:5985/wsman" username="administrator" password="p@ssword1" timeoutMilliseconds="1000" authType="Negotiate"/>
    </Servers> 
		
    <Schedules> 
	  <!--Local Metrics -->
	  <add name="Varonis Solr Loader" query="win_perfmon_varonis_solr_loader" input="perfmon" intervalSeconds="5" />
	  <!-- Keep disk perfmon since latency metrics seems not to work in wmi -->
      <add name="perfmon_disk1" query="perfmon_disk1" input="perfmon" intervalSeconds="10" />
	  <add name="perfmon_disk5" query="perfmon_disk5" input="perfmon" intervalSeconds="10" />
	  <add name="process1" query="perfmon_process_sqlextractor" input="perfmon" intervalSeconds="10" />
	  <add name="process5" query="perfmon_process_solrdataindexer" input="perfmon" intervalSeconds="10" />
	  <add name="process2" query="perfmon_process_datalake" input="perfmon" intervalSeconds="10" />
	  <add name="process4" query="perfmon_process_solrloader" input="perfmon" intervalSeconds="10" />
	  <add name="perfmon_varonis_solrloader" query="perfmon_varonis_solrloader" input="perfmon" intervalSeconds="10" />
	  <!-- .NET metrics for Varois services exist only in Perfmon -->
	  <add name="NetExceptions_sqlextractor" query="perfmon_net_exceptions_sqlextractor" input="perfmon" intervalSeconds="20" />
	  <add name="NetLockandThreads_sqlextractor" query="perfmon_net_lockandthreads_sqlextractor" input="perfmon" intervalSeconds="20" />
	  <add name="NetMemory_sqlextractor" query="perfmon_net_memory_sqlextractor" input="perfmon" intervalSeconds="10" />	  
	  <add name="NetExceptions_solrloader" query="perfmon_net_exceptions_solrloader" input="perfmon" intervalSeconds="20" />
	  <add name="NetLockandThreads_solrloader" query="perfmon_net_lockandthreads_solrloader" input="perfmon" intervalSeconds="20" />
	  <add name="NetMemory_solrloader" query="perfmon_net_memory_solrloader" input="perfmon" intervalSeconds="10" />
	  <add name="NetExceptions_solrdataindexer" query="perfmon_net_exceptions_solrdataindexer" input="perfmon" intervalSeconds="20" />
	  <add name="NetLocksandThreads_solrdataindexer" query="perfmon_net_locksandthreads_solrdataindexer" input="perfmon" intervalSeconds="20" />
	  <add name="NetMemory_solrdataindexer" query="perfmon_net_memory_solrdataindexer" input="perfmon" intervalSeconds="10" />
	  <add name="NetExceptions_datalake" query="perfmon_net_exceptions_datalake" input="perfmon" intervalSeconds="20" />
	  <add name="NetLocksandThreads_datalake" query="perfmon_net_locksandthreads_datalake" input="perfmon" intervalSeconds="20" />
	  <add name="NetMemory_datalake" query="perfmon_net_memory_datalake" input="perfmon" intervalSeconds="10" />
	  <add name="NetExceptions_DBAdapter" query="perfmon_net_exceptions_DBAdapter" input="perfmon" intervalSeconds="20" />
	  <add name="NetLocksandThreads_DBAdapter" query="perfmon_net_locksandthreads_DBAdapter" input="perfmon" intervalSeconds="20" />
	  <add name="NetMemory_DBAdapter" query="perfmon_net_memory_DBAdapter" input="perfmon" intervalSeconds="10" />
	  <add name="perfmon_varonis_DBAdapter_v3" query="perfmon_varonis_DBAdapter_v3" input="perfmon" intervalSeconds="10" />
      <add name="Varonis Sql Extractor" query="perfmon_varonis_sqlextractor" input="perfmon" intervalSeconds="20" />
	  <add name="wmi_network_adapter_sonar" query="wmi_network_adapter_sonar" input="sonar" intervalSeconds="20" />
	  <add name="wmi_process_sonar" query="wmi_process_sonar" input="sonar" intervalSeconds="10" />
	  <add name="wmi_service_sonar" query="wmi_service_sonar" input="sonar" intervalSeconds="20" />
	  <add name="wmi_disk_logical_sonar" query="wmi_disk_logical_sonar" input="sonar" intervalSeconds="20" />
	  <add name="wmi_memory_sonar" query="wmi_memory_sonar" input="sonar" intervalSeconds="10" />
	  <add name="wmi_processor_sonar" query="wmi_processor_sonar" input="sonar" intervalSeconds="20" />
	  <add name="wmi_system_sonar" query="wmi_system_sonar" input="sonar" intervalSeconds="20" />
	  <add name="wmi_paging_sonar" query="wmi_paging_sonar" input="sonar" intervalSeconds="20" />
	  <add name="wmi_computersystem_sonar" query="wmi_computersystem_sonar" input="sonar" intervalSeconds="60" />
	  
	  <!-- IMORTANT! make sure to change sqldb to the correct Shadow DB you have folders-->
	  <!--DB Metrics\Queries -->
	  <add name="dbquery02" query="db_sqlextractor_batches_metrics" input="sqldb_vrnsdomaindb" intervalSeconds="60" />
	  <add name="dbquery07" query="db_sqlextractor_batches_totaldoccount_metrics" input="sqldb_vrnsdomaindb" intervalSeconds="10" />
	  <add name="dbquery08" query="db_solrdataindexer_batches_totaldoccount_metrics" input="sqldb_vrnsdomaindb" intervalSeconds="10" />
	  <add name="dbquery10" query="db_shadowdb_backlog_missingevents" input="sqldb" intervalSeconds="60" />
	  <add name="wmi_network_adapter_db" query="wmi_network_adapter_db" input="db" intervalSeconds="20" />
	  <add name="wmi_disk_logical_db_TempDB" query="wmi_disk_logical_db_TempDB" input="db" intervalSeconds="20" />
	  <add name="wmi_disk_logical_db_LogDB" query="wmi_disk_logical_db_LogDB" input="db" intervalSeconds="20" />
	  <add name="wmi_disk_logical_db_DataDB" query="wmi_disk_logical_db_DataDB" input="db" intervalSeconds="20" />
	  <add name="wmi_disk_logical_db_OS" query="wmi_disk_logical_db_OS" input="db" intervalSeconds="20" />
	  <add name="wmi_memory_db" query="wmi_memory_db" input="db" intervalSeconds="10" />
	  <add name="wmi_processor_db" query="wmi_processor_db" input="db" intervalSeconds="20" />
	  <add name="wmi_system_db" query="wmi_system_db" input="db" intervalSeconds="20" />
	  <add name="wmi_paging_db" query="wmi_paging_db" input="db" intervalSeconds="20" />
	  <add name="wmi_mssql_workloadgroupstats_db" query="wmi_mssql_workloadgroupstats_db" input="db" intervalSeconds="20" />
	  <add name="wmi_mssql_waitstatistics_db" query="wmi_mssql_waitstatistics_db" input="db" intervalSeconds="20" />
	  <add name="wmi_mssql_transactions_db" query="wmi_mssql_transactions_db" input="db" intervalSeconds="20" />
	  <add name="wmi_mssql_memorymanager_db" query="wmi_mssql_memorymanager_db" input="db" intervalSeconds="20" />
	  <add name="wmi_mssql_latches_db" query="wmi_mssql_latches_db" input="db" intervalSeconds="20" />
	  <add name="wmi_mssql_buffermanager_db" query="wmi_mssql_buffermanager_db" input="db" intervalSeconds="10" />
	  <add name="wmi_mssql_locks_db" query="wmi_mssql_locks_db" input="db" intervalSeconds="20" />
	  <add name="wmi_mssql_generalstatistics_db" query="wmi_mssql_generalstatistics_db" input="db" intervalSeconds="20" />
	  <add name="wmi_computersystem_db" query="wmi_computersystem_db" input="db" intervalSeconds="60" />
	  
	  <!-- Solr metrics -->
	  
    </Schedules>
	
    <Queries>
		<add name="win_perfmon_varonis_solr_loader" type="raw" filter="" resource="." namespace="Varonis Solr Loader">
			<Tags><add name="Name" value="Name"/></Tags>
			<Values>
			   <add name="idu_documents_loaded_to_solr_total" value="Documents Loaded To Solr - Total"/>
			   <add name="idu_documents_loaded_to_solr_rate_docs_per_sec" value="Documents Loaded To Solr - Rate (Docs per second)"/>
			   <add name="idu_bulks_failures_total" value="Bulks Failures - Total"/>
			   <add name="idu_event_age_in_minutes_avaerage" value="Event Age In Minutes - Average"/>
			   <add name="idu_num_working_writers" value="# Working Writers"/>
			</Values>
		</add>

		<add name="wmi_computersystem_sonar"
             filter="select NumberOfLogicalProcessors, TotalPhysicalMemory from Win32_ComputerSystem"
             resource="http://schemas.microsoft.com/wbem/wsman/1/wmi/root/cimv2/*" namespace="root\cimv2">
            <Values>
				<add name="NumberOfLogicalProcessors" value="CimType.UInt16"/>
				<add name="TotalPhysicalMemory" value="CimType.UInt64"/>
            </Values>
        </add>
		
		<add name="wmi_computersystem_db"
             filter="select NumberOfLogicalProcessors, TotalPhysicalMemory from Win32_ComputerSystem"
             resource="http://schemas.microsoft.com/wbem/wsman/1/wmi/root/cimv2/*" namespace="root\cimv2">
            <Values>
				<add name="NumberOfLogicalProcessors" value="CimType.UInt16"/>
				<add name="TotalPhysicalMemory" value="CimType.UInt64"/>
            </Values>
        </add>
	
		<add name="wmi_mssql_workloadgroupstats_db"
             filter="select CPUusagePercent from Win32_PerfFormattedData_MSSQLR2_MSSQLR2WorkloadGroupStats"
             resource="http://schemas.microsoft.com/wbem/wsman/1/wmi/root/cimv2/*" namespace="root\cimv2">
            <Values>
				<add name="CPUusagePercent" value="CimType.UInt16"/>
            </Values>
        </add>
		
		<add name="wmi_mssql_waitstatistics_db"
             filter="select Lockwaits, Memorygrantqueuewaits from Win32_PerfFormattedData_MSSQLR2_MSSQLR2WaitStatistics where Name='Waits in progress'"
             resource="http://schemas.microsoft.com/wbem/wsman/1/wmi/root/cimv2/*" namespace="root\cimv2">
            <Values>
				<add name="Lockwaits" value="CimType.UInt64"/>
				<add name="Memorygrantqueuewaits" value="CimType.UInt32"/>
            </Values>
        </add>
	
		<add name="wmi_mssql_transactions_db"
             filter="select LongestTransactionRunningTime from Win32_PerfFormattedData_MSSQLR2_MSSQLR2Transactions"
             resource="http://schemas.microsoft.com/wbem/wsman/1/wmi/root/cimv2/*" namespace="root\cimv2">
            <Values>
				<add name="LongestTransactionRunningTime" value="CimType.UInt64"/>
            </Values>
        </add>
	
		<add name="wmi_mssql_memorymanager_db"
             filter="select GrantedWorkspaceMemoryKB from Win32_PerfFormattedData_MSSQLR2_MSSQLR2MemoryManager"
             resource="http://schemas.microsoft.com/wbem/wsman/1/wmi/root/cimv2/*" namespace="root\cimv2">
            <Values>
				<add name="GrantedWorkspaceMemoryKB" value="CimType.UInt64"/>
            </Values>
        </add>
	
		<add name="wmi_mssql_latches_db"
             filter="select LatchWaitsPersec, AverageLatchWaitTimems from Win32_PerfFormattedData_MSSQLR2_MSSQLR2Latches"
             resource="http://schemas.microsoft.com/wbem/wsman/1/wmi/root/cimv2/*" namespace="root\cimv2">
            <Values>
				<add name="LatchWaitsPersec" value="CimType.UInt32"/>
				<add name="AverageLatchWaitTimems" value="CimType.UInt64"/>
            </Values>
        </add>
	
		<add name="wmi_mssql_buffermanager_db"
             filter="select Pagelifeexpectancy,LazywritesPersec, Buffercachehitratio from Win32_PerfFormattedData_MSSQLR2_MSSQLR2BufferManager"
             resource="http://schemas.microsoft.com/wbem/wsman/1/wmi/root/cimv2/*" namespace="root\cimv2">
            <Values>
				<add name="Pagelifeexpectancy" value="CimType.UInt64"/>
				<add name="LazywritesPersec" value="CimType.UInt32"/>
				<add name="Buffercachehitratio" value="CimType.UInt16"/>
            </Values>
        </add>
		
		<add name="wmi_mssql_locks_db"
             filter="select Name, LockWaitsPersec, AverageWaitTimems, LockTimeoutsPersec, NumberofDeadlocksPersec from Win32_PerfFormattedData_MSSQLR2_MSSQLR2Locks where Name='_Total'"
             resource="http://schemas.microsoft.com/wbem/wsman/1/wmi/root/cimv2/*" namespace="root\cimv2">
            <Tags>
                <add name="Name" value = "Name"/>
            </Tags>
			<Values>
				<add name="LockWaitsPersec" value="CimType.UInt32"/>
				<add name="AverageWaitTimems" value="CimType.UInt64"/>
				<add name="LockTimeoutsPersec" value="CimType.UInt32"/>
				<add name="NumberofDeadlocksPersec" value="CimType.UInt32"/>
            </Values>
        </add>
		
		<add name="wmi_mssql_generalstatistics_db"
             filter="select UserConnections, Processesblocked from Win32_PerfFormattedData_MSSQLR2_MSSQLR2GeneralStatistics"
             resource="http://schemas.microsoft.com/wbem/wsman/1/wmi/root/cimv2/*" namespace="root\cimv2">
			<Values>
				<add name="Processesblocked" value="CimType.UInt32"/>
            </Values>
        </add>
		
		<add name="wmi_service_sonar"
             filter="select Name, ProcessId from Win32_Service where Name like 'Varonis.%'"
             resource="http://schemas.microsoft.com/wbem/wsman/1/wmi/root/cimv2/*" namespace="root\cimv2">
            <Tags>
                <add name="Name" value = "Name"/>
            </Tags>
            <Values>
				<add name="ProcessId" value="CimType.UInt64"/>
            </Values>
        </add>
	
		<add name="wmi_process_sonar"
             filter="select Name, HandleCount, PrivateBytes, ThreadCount, PrivateBytes, WorkingSet from Win32_PerfFormattedData_PerfProc_Process where Name like 'Varonis.%'"
             resource="http://schemas.microsoft.com/wbem/wsman/1/wmi/root/cimv2/*" namespace="root\cimv2">
            <Tags>
                <add name="Name" value = "Name"/>
            </Tags>
            <Values>
                 <add name="HandleCount" value="CimType.UInt32"/>
				 <add name="ThreadCount" value="CimType.UInt32"/>
				 <add name="PrivateBytes" value="CimType.UInt64"/>
				 <add name="WorkingSet" value="CimType.UInt64"/>
            </Values>
        </add>
		
		<add name="wmi_network_adapter_sonar"
             filter="select Name, OutputQueueLength, BytesTotalPersec, CurrentBandwidth, PacketsOutboundDiscarded, PacketsOutboundErrors, PacketsReceivedDiscarded, PacketsReceivedErrors, PacketsReceivedPersec, PacketsSentPersec from Win32_PerfFormattedData_Tcpip_NetworkAdapter where Name like '%vmxnet3 Ethernet Adapter%'"
             resource="http://schemas.microsoft.com/wbem/wsman/1/wmi/root/cimv2/*" namespace="root\cimv2">
            <Tags>
                <add name="Name" value = "Name"/>
            </Tags>
            <Values>
                 <add name="OutputQueueLength" value="CimType.UInt32"/>
				 <add name="BytesTotalPersec" value="CimType.UInt64"/>
                 <add name="CurrentBandwidth" value="CimType.UInt64"/>
				 <add name="PacketsOutboundDiscarded" value="CimType.UInt16"/>
				 <add name="PacketsOutboundErrors" value="CimType.UInt16"/>
				 <add name="PacketsReceivedDiscarded" value="CimType.UInt16"/>
				 <add name="PacketsReceivedErrors" value="CimType.UInt16"/>
				 <add name="PacketsReceivedPersec" value="CimType.UInt32"/>
				 <add name="PacketsSentPersec" value="CimType.UInt32"/>
            </Values>
        </add>
		
		<add name="wmi_network_adapter_db"
             filter="select Name, OutputQueueLength, BytesTotalPersec, CurrentBandwidth, PacketsOutboundDiscarded, PacketsOutboundErrors, PacketsReceivedDiscarded, PacketsReceivedErrors, PacketsReceivedPersec, PacketsSentPersec from Win32_PerfFormattedData_Tcpip_NetworkAdapter where Name like '%Microsoft Hyper-V Network Adapter%'"
             resource="http://schemas.microsoft.com/wbem/wsman/1/wmi/root/cimv2/*" namespace="root\cimv2">
            <Tags>
                <add name="Name" value = "Name"/>
            </Tags>
            <Values>
                 <add name="OutputQueueLength" value="CimType.UInt32"/>
				 <add name="BytesTotalPersec" value="CimType.UInt64"/>
                 <add name="CurrentBandwidth" value="CimType.UInt64"/>
				 <add name="PacketsOutboundDiscarded" value="CimType.UInt16"/>
				 <add name="PacketsOutboundErrors" value="CimType.UInt16"/>
				 <add name="PacketsReceivedDiscarded" value="CimType.UInt16"/>
				 <add name="PacketsReceivedErrors" value="CimType.UInt16"/>
				 <add name="PacketsReceivedPersec" value="CimType.UInt32"/>
				 <add name="PacketsSentPersec" value="CimType.UInt32"/>
            </Values>
        </add>
		
		<add name="wmi_disk_logical_sonar"
             filter="select Name, PercentFreeSpace, AvgDisksecPerRead, AvgDisksecPerWrite, AvgDisksecPerTransfer, DiskBytesPersec, DiskTransfersPersec from Win32_PerfFormattedData_PerfDisk_LogicalDisk where Name='E:'"
             resource="http://schemas.microsoft.com/wbem/wsman/1/wmi/root/cimv2/*" namespace="root\cimv2">
            <Tags>
                <add name="Name" value = "Name"/>
            </Tags>
            <Values>
                 <add name="PercentFreeSpace" value="CimType.UInt8"/>
				 <add name="AvgDisksecPerRead" value="CimType.UInt16"/>
				 <add name="AvgDisksecPerWrite" value="CimType.UInt16"/>
				 <add name="AvgDisksecPerTransfer" value="CimType.UInt16"/>
				 <add name="DiskBytesPersec" value="CimType.UInt64"/>
				 <add name="DiskTransfersPersec" value="CimType.UInt32"/>
            </Values>
        </add>
		
		<add name="wmi_disk_logical_db_TempDB"
             filter="select Name, PercentFreeSpace, AvgDisksecPerRead, AvgDisksecPerWrite, AvgDisksecPerTransfer, DiskBytesPersec, DiskTransfersPersec from Win32_PerfFormattedData_PerfDisk_LogicalDisk where Name='F:'"
             resource="http://schemas.microsoft.com/wbem/wsman/1/wmi/root/cimv2/*" namespace="root\cimv2">
            <Tags>
                <add name="Name" value = "Name"/>
            </Tags>
            <Values>
                 <add name="PercentFreeSpace" value="CimType.UInt8"/>
				 <add name="AvgDisksecPerRead" value="CimType.UInt16"/>
				 <add name="AvgDisksecPerWrite" value="CimType.UInt16"/>
				 <add name="AvgDisksecPerTransfer" value="CimType.UInt16"/>
				 <add name="DiskBytesPersec" value="CimType.UInt64"/>
				 <add name="DiskTransfersPersec" value="CimType.UInt32"/>
            </Values>
        </add>
		
		<add name="wmi_disk_logical_db_OS"
             filter="select Name, PercentFreeSpace, AvgDisksecPerRead, AvgDisksecPerWrite, AvgDisksecPerTransfer, DiskBytesPersec, DiskTransfersPersec from Win32_PerfFormattedData_PerfDisk_LogicalDisk where Name='C:'"
             resource="http://schemas.microsoft.com/wbem/wsman/1/wmi/root/cimv2/*" namespace="root\cimv2">
            <Tags>
                <add name="Name" value = "Name"/>
            </Tags>
            <Values>
                 <add name="PercentFreeSpace" value="CimType.UInt8"/>
				 <add name="AvgDisksecPerRead" value="CimType.UInt16"/>
				 <add name="AvgDisksecPerWrite" value="CimType.UInt16"/>
				 <add name="AvgDisksecPerTransfer" value="CimType.UInt16"/>
				 <add name="DiskBytesPersec" value="CimType.UInt64"/>
				 <add name="DiskTransfersPersec" value="CimType.UInt32"/>
            </Values>
        </add>
		
		<add name="wmi_disk_logical_db_LogDB"
             filter="select Name, PercentFreeSpace, AvgDisksecPerRead, AvgDisksecPerWrite, AvgDisksecPerTransfer, DiskBytesPersec, DiskTransfersPersec from Win32_PerfFormattedData_PerfDisk_LogicalDisk where Name='E:'"
             resource="http://schemas.microsoft.com/wbem/wsman/1/wmi/root/cimv2/*" namespace="root\cimv2">
            <Tags>
                <add name="Name" value = "Name"/>
            </Tags>
            <Values>
                 <add name="PercentFreeSpace" value="CimType.UInt8"/>
				 <add name="AvgDisksecPerRead" value="CimType.UInt16"/>
				 <add name="AvgDisksecPerWrite" value="CimType.UInt16"/>
				 <add name="AvgDisksecPerTransfer" value="CimType.UInt16"/>
				 <add name="DiskBytesPersec" value="CimType.UInt64"/>
				 <add name="DiskTransfersPersec" value="CimType.UInt32"/>
            </Values>
        </add>
		
		<add name="wmi_disk_logical_db_DataDB"
             filter="select Name, PercentFreeSpace, AvgDisksecPerRead, AvgDisksecPerWrite, AvgDisksecPerTransfer, DiskBytesPersec, DiskTransfersPersec from Win32_PerfFormattedData_PerfDisk_LogicalDisk where Name='G:'"
             resource="http://schemas.microsoft.com/wbem/wsman/1/wmi/root/cimv2/*" namespace="root\cimv2">
            <Tags>
                <add name="Name" value = "Name"/>
            </Tags>
            <Values>
                 <add name="PercentFreeSpace" value="CimType.UInt8"/>
				 <add name="AvgDisksecPerRead" value="CimType.UInt16"/>
				 <add name="AvgDisksecPerWrite" value="CimType.UInt16"/>
				 <add name="AvgDisksecPerTransfer" value="CimType.UInt16"/>
				 <add name="DiskBytesPersec" value="CimType.UInt64"/>
				 <add name="DiskTransfersPersec" value="CimType.UInt32"/>
            </Values>
        </add>
		
		<add name="wmi_memory_sonar" 
            filter="SELECT Name, AvailableMBytes FROM Win32_PerfFormattedData_PerfOS_Memory" 
            resource="http://schemas.microsoft.com/wbem/wsman/1/wmi/root/cimv2/*" namespace="root\cimv2">
            <Tags>
                <add name="Name" value = "Name"/>
            </Tags>
            <Values>
                <add name="AvailableMBytes" value="CimType.UInt64" />
			</Values>
		</add>
		
		<add name="wmi_memory_db" 
            filter="SELECT Name, AvailableMBytes FROM Win32_PerfFormattedData_PerfOS_Memory" 
            resource="http://schemas.microsoft.com/wbem/wsman/1/wmi/root/cimv2/*" namespace="root\cimv2">
            <Tags>
                <add name="Name" value = "Name"/>
            </Tags>
            <Values>
                <add name="AvailableMBytes" value="CimType.UInt64" />
			</Values>
		</add>
		
		<add name="wmi_paging_sonar" 
            filter="select Name, PercentUsage from Win32_PerfFormattedData_PerfOS_PagingFile where Name='_Total'" 
            resource="http://schemas.microsoft.com/wbem/wsman/1/wmi/root/cimv2/*" namespace="root\cimv2">
            <Tags>
                <add name="Name" value = "Name"/>
            </Tags>
            <Values>
                <add name="PercentUsage" value="CimType.UInt16" />
			</Values>
		</add>
		
		<add name="wmi_paging_db" 
            filter="select Name, PercentUsage from Win32_PerfFormattedData_PerfOS_PagingFile where Name='_Total'" 
            resource="http://schemas.microsoft.com/wbem/wsman/1/wmi/root/cimv2/*" namespace="root\cimv2">
            <Tags>
                <add name="Name" value = "Name"/>
            </Tags>
            <Values>
                <add name="PercentUsage" value="CimType.UInt16" />
			</Values>
		</add>
		
		<add name="wmi_processor_sonar" 
            filter="select Name,PercentProcessorTime from Win32_PerfFormattedData_PerfOS_Processor where Name='_Total'" 
            resource="http://schemas.microsoft.com/wbem/wsman/1/wmi/root/cimv2/*" namespace="root\cimv2">
            <Tags>
                <add name="Name" value = "Name"/>
            </Tags>
            <Values>
                <add name="PercentProcessorTime" value="CimType.UInt64"/>
            </Values>
        </add>
		
		<add name="wmi_processor_db" 
            filter="select Name,PercentProcessorTime from Win32_PerfFormattedData_PerfOS_Processor where Name='_Total'" 
            resource="http://schemas.microsoft.com/wbem/wsman/1/wmi/root/cimv2/*" namespace="root\cimv2">
            <Tags>
                <add name="Name" value = "Name"/>
            </Tags>
            <Values>
                <add name="PercentProcessorTime" value="CimType.UInt64"/>
            </Values>
        </add>
		
		<add name="wmi_system_sonar" 
            filter="select ProcessorQueueLength, ContextSwitchesPersec from Win32_PerfFormattedData_PerfOS_System" 
            resource="http://schemas.microsoft.com/wbem/wsman/1/wmi/root/cimv2/*" namespace="root\cimv2">
            <Tags>
                <add name="Name" value = "Name"/>
            </Tags>
            <Values>
                <add name="ProcessorQueueLength" value="CimType.UInt16"/>
				<add name="ContextSwitchesPersec" value="CimType.UInt64"/>
            </Values>
        </add>
		
		<add name="wmi_system_db" 
            filter="select ProcessorQueueLength, ContextSwitchesPersec from Win32_PerfFormattedData_PerfOS_System" 
            resource="http://schemas.microsoft.com/wbem/wsman/1/wmi/root/cimv2/*" namespace="root\cimv2">
            <Tags>
                <add name="Name" value = "Name"/>
            </Tags>
            <Values>
                <add name="ProcessorQueueLength" value="CimType.UInt16"/>
				<add name="ContextSwitchesPersec" value="CimType.UInt64"/>
            </Values>
        </add>
		
		<add name="wmi_system_solr" 
            filter="select ProcessorQueueLength, ContextSwitchesPersec from Win32_PerfFormattedData_PerfOS_System" 
            resource="http://schemas.microsoft.com/wbem/wsman/1/wmi/root/cimv2/*" namespace="root\cimv2">
            <Tags>
                <add name="Name" value = "Name"/>
            </Tags>
            <Values>
                <add name="ProcessorQueueLength" value="CimType.UInt16"/>
				<add name="ContextSwitchesPersec" value="CimType.UInt64"/>
            </Values>
        </add>
		
		<add name="db_sqlextractor_batches_metrics" type="sql" filter="select top 300 BatchId, DataSourceId, DATEDIFF( second, StartTime, EndTime) as TimeDiffInSec, StartTime, EndTime, Status, DocCount,Retries=ISL1648-DV1(Retries, '0'),LastRetryFailed from dbo.SqlExtractor_Batches where DataSourceId>9 order by StartTime desc;">
		<Tags>
			<add name="BatchId" value="BatchId" />
			<add name="Status" value="Status"/>
			<add name="Retries" value="Retries" />
			<add name="LastRetryFailed" value="LastRetryFailed" />
			<add name="DocCount" value="DocCount" />
		</Tags>
		<Values>
			<add name="TimeDiffInMS" value="auto" />
		</Values>
        </add>
						
		<add name="db_sqlextractor_batches_totaldoccount_metrics" type="sql" filter="select TotalDocCount=SUM(CONVERT(BIGINT, DocCount)) from dbo.SqlExtractor_Batches where Status=1 group by Status;">
		<Values>
			<add name="TotalDocCount" value="auto" />
		</Values>
        </add>
		
		<add name="db_solrdataindexer_batches_totaldoccount_metrics" type="sql" filter="select TotalDocCount=SUM(CONVERT(BIGINT, DocCount)) from dbo.SolrDataIndexer_Batches where BatchStatus=1 group by BatchStatus;">
		<Values>
			<add name="TotalDocCount" value="auto" />
		</Values>
        </add>
						
		<add name="db_shadowdb_backlog_missingevents" type="sql" filter="DECLARE @filerid INT;SELECT @filerid=filer_id FROM dbo.filers;WITH cte AS(SELECT FilerId,SourceTableOrView,Timestamp,DocumentTypeDescription,MAX(BatchEndId) AS maxBatchID FROM VrnsDomainDb..vwSqlExtractor_Metadata WHERE FilerId=@filerid AND isalertedEvents=0 GROUP BY FilerId,SourceTableOrView,Timestamp,DocumentTypeDescription) SELECT MissigEvent_Backlog=sum(a.MaxEventID-b.maxBatchID), b.FilerId FROM EventsMaxId a JOIN cte b ON a.TableDate=b.Timestamp AND a.TargetTypeID=b.SourceTableOrView WHERE a.MaxEventID >b.maxBatchID group by b.FilerId;">
		<Tags>
			<add name="FilerId" value="FilerId" />
		</Tags>
		<Values>
			<add name="MissigEvent_Backlog" value="auto" />
		</Values>
        </add>
					
		<add name="perfmon_disk1" type="raw" filter="" resource="." namespace="LogicalDisk(C:)">
		<Tags> <add name="Name" value = "Name"/> </Tags>
		<Values>
		  <add name="precent_free_space_OS_Partition" value="% Free Space"/>
		  <add name="avg_disk_sec_read_OS_Partition" value="Avg. Disk sec/Read"/>
		  <add name="avg_disk_sec_transfer_OS_Partition" value="Avg. Disk sec/Transfer"/>
		  <add name="avg_disk_sec_Write_OS_Partition" value="Avg. Disk sec/Write"/>
		  <add name="disk_Bytes_sec_OS_Partition" value="Disk Bytes/sec"/>
		  <add name="disk_Transfers_sec_OS_Partition" value="Disk Transfers/sec"/>
		</Values>
		</add>
		
		<add name="perfmon_disk5" type="raw" filter="" resource="." namespace="LogicalDisk(E:)">
		<Tags> <add name="Name" value = "Name"/> </Tags>
		<Values>
		  <add name="avg_disk_sec_read_DataLake_Partition" value="Avg. Disk sec/Read"/>
		  <add name="avg_disk_sec_Write_DataLake_Partition" value="Avg. Disk sec/Write"/>
		</Values>
		</add>
		
		<add name="perfmon_process_sqlextractor" type="raw" filter="" resource="." namespace="Process(Varonis.SqlExtractor)">
		<Tags> <add name="Name" value = "Name"/> </Tags>
		<Values>
		  <add name="precent_processor_time" value="% Processor Time"/>
		</Values>
		</add>
		
		<add name="perfmon_process_solrdataindexer" type="raw" filter="" resource="." namespace="Process(Varonis.SolrDataIndexer.Service)">
		<Tags> <add name="Name" value = "Name"/> </Tags>
		<Values>
		  <add name="precent_processor_time" value="% Processor Time"/>
		</Values>
		</add>
		
		<add name="perfmon_process_solrloader" type="raw" filter="" resource="." namespace="Process(Varonis.SolrLoader.Service)">
		<Tags> <add name="Name" value = "Name"/> </Tags>
		<Values>
		  <add name="precent_processor_time" value="% Processor Time"/>
		</Values>
		</add>
		
		<add name="perfmon_process_datalake" type="raw" filter="" resource="." namespace="Process(Varonis.DataLake.Management.Service)">
		<Tags> <add name="Name" value = "Name"/> </Tags>
		<Values>
		  <add name="precent_processor_time" value="% Processor Time"/>
		</Values>
		</add>
		
		<add name="perfmon_net_exceptions_sqlextractor" type="raw" filter="" resource="." namespace=".NET CLR Exceptions(Varonis.SqlExtractor)">
		<Tags><add name="Name" value="Name"/></Tags>
		<Values>
		   <add name="exceptions_total" value="# of Exceps Thrown"/>
		   <add name="exceptions_per_sec" value="# of Exceps Thrown / sec"/>
		</Values>
		</add>
		
		<add name="perfmon_net_lockandthreads_sqlextractor" type="raw" filter="" resource="." namespace=".NET CLR LocksandThreads(Varonis.SqlExtractor)">
		<Tags><add name="Name" value="Name"/></Tags>
		<Values>
		   <add name="num_current_physical_threads" value="# of current physical Threads"/>
		   <add name="contention_rate_sec" value="Contention Rate / sec"/>
		   <add name="current_queue_length" value="Current Queue Length"/>
		</Values>
		</add>
		
		<add name="perfmon_net_memory_sqlextractor" type="raw" filter="" resource="." namespace=".NET CLR Memory(Varonis.SqlExtractor)">
		<Tags><add name="Name" value="Name"/></Tags>
		<Values>
		   <add name="precent_time_in_gc" value="% Time in GC"/>
		   <add name="num_pinned_objects" value="# of Pinned Objects"/>
		   <add name="num_gen_2_collections" value="# Gen 2 Collections"/>
		   <add name="num_gen_1_collections" value="# Gen 1 Collections"/>
		   <add name="num_gen_0_collections" value="# Gen 0 Collections"/>
		   <add name="num_bytes_in_all_heaps" value="# Bytes in all Heaps"/>
		   <add name="large_object_heap_size" value="Large Object Heap size"/>
		</Values>
		</add>
		
		<add name="perfmon_net_exceptions_solrloader" type="raw" filter="" resource="." namespace=".NET CLR Exceptions(Varonis.SolrLoader.Service)">
		<Tags><add name="Name" value="Name"/></Tags>
		<Values>
		   <add name="exceptions_total" value="# of Exceps Thrown"/>
		   <add name="exceptions_per_sec" value="# of Exceps Thrown / sec"/>
		</Values>
		</add>
		
		<add name="perfmon_net_lockandthreads_solrloader" type="raw" filter="" resource="." namespace=".NET CLR LocksandThreads(Varonis.SolrLoader.Service)">
		<Tags><add name="Name" value="Name"/></Tags>
		<Values>
		   <add name="num_current_physical_threads" value="# of current physical Threads"/>
		   <add name="contention_rate_sec" value="Contention Rate / sec"/>
		   <add name="current_queue_length" value="Current Queue Length"/>
		</Values>
		</add>
		
		<add name="perfmon_net_memory_solrloader" type="raw" filter="" resource="." namespace=".NET CLR Memory(Varonis.SolrLoader.Service)">
		<Tags><add name="Name" value="Name"/></Tags>
		<Values>
		   <add name="precent_time_in_gc" value="% Time in GC"/>
		   <add name="num_pinned_objects" value="# of Pinned Objects"/>
		   <add name="num_gen_2_collections" value="# Gen 2 Collections"/>
		   <add name="num_gen_1_collections" value="# Gen 1 Collections"/>
		   <add name="num_gen_0_collections" value="# Gen 0 Collections"/>
		   <add name="num_bytes_in_all_heaps" value="# Bytes in all Heaps"/>
		   <add name="large_object_heap_size" value="Large Object Heap size"/>
		</Values>
		</add>
		
		<add name="perfmon_net_exceptions_solrdataindexer" type="raw" filter="" resource="." namespace=".NET CLR Exceptions(Varonis.SolrDataIndexer.Service)">
		<Tags><add name="Name" value="Name"/></Tags>
		<Values>
		   <add name="exceptions_total" value="# of Exceps Thrown"/>
		   <add name="exceptions_per_sec" value="# of Exceps Thrown / sec"/>
		</Values>
		</add>
		
		<add name="perfmon_net_locksandthreads_solrdataindexer" type="raw" filter="" resource="." namespace=".NET CLR LocksandThreads(Varonis.SolrDataIndexer.Service)">
		<Tags><add name="Name" value="Name"/></Tags>
		<Values>
		   <add name="num_current_physical_threads" value="# of current physical Threads"/>
		   <add name="contention_rate_sec" value="Contention Rate / sec"/>
		   <add name="current_queue_length" value="Current Queue Length"/>
		</Values>
		</add>
		
		<add name="perfmon_net_memory_solrdataindexer" type="raw" filter="" resource="." namespace=".NET CLR Memory(Varonis.SolrDataIndexer.Service)">
		<Tags><add name="Name" value="Name"/></Tags>
		<Values>
		   <add name="precent_time_in_gc" value="% Time in GC"/>
		   <add name="num_pinned_objects" value="# of Pinned Objects"/>
		   <add name="num_gen_2_collections" value="# Gen 2 Collections"/>
		   <add name="num_gen_1_collections" value="# Gen 1 Collections"/>
		   <add name="num_gen_0_collections" value="# Gen 0 Collections"/>
		   <add name="num_bytes_in_all_heaps" value="# Bytes in all Heaps"/>
		   <add name="large_object_heap_size" value="Large Object Heap size"/>
		</Values>
		</add>
		
		<add name="perfmon_net_exceptions_datalake" type="raw" filter="" resource="." namespace=".NET CLR Exceptions(Varonis.DataLake.Management.Service)">
		<Tags><add name="Name" value="Name"/></Tags>
		<Values>
		   <add name="exceptions_total" value="# of Exceps Thrown"/>
		   <add name="exceptions_per_sec" value="# of Exceps Thrown / sec"/>
		</Values>
		</add>
		
		<add name="perfmon_net_locksandthreads_datalake" type="raw" filter="" resource="." namespace=".NET CLR LocksandThreads(Varonis.DataLake.Management.Service)">
		<Tags><add name="Name" value="Name"/></Tags>
		<Values>
		   <add name="num_current_physical_threads" value="# of current physical Threads"/>
		   <add name="contention_rate_sec" value="Contention Rate / sec"/>
		   <add name="current_queue_length" value="Current Queue Length"/>
		</Values>
		</add>
		
		<add name="perfmon_net_memory_datalake" type="raw" filter="" resource="." namespace=".NET CLR Memory(Varonis.DataLake.Management.Service)">
		<Tags><add name="Name" value="Name"/></Tags>
		<Values>
		   <add name="precent_time_in_gc" value="% Time in GC"/>
		   <add name="num_pinned_objects" value="# of Pinned Objects"/>
		   <add name="num_gen_2_collections" value="# Gen 2 Collections"/>
		   <add name="num_gen_1_collections" value="# Gen 1 Collections"/>
		   <add name="num_gen_0_collections" value="# Gen 0 Collections"/>
		   <add name="num_bytes_in_all_heaps" value="# Bytes in all Heaps"/>
		   <add name="large_object_heap_size" value="Large Object Heap size"/>
		</Values>
		</add>
		
		<add name="perfmon_net_exceptions_DBAdapter" type="raw" filter="" resource="." namespace=".NET CLR Exceptions(Varonis.DbAdapter.WindowsService)">
		<Tags><add name="Name" value="Name"/></Tags>
		<Values>
		   <add name="exceptions_total" value="# of Exceps Thrown"/>
		   <add name="exceptions_per_sec" value="# of Exceps Thrown / sec"/>
		</Values>
		</add>
		
		<add name="perfmon_net_locksandthreads_DBAdapter" type="raw" filter="" resource="." namespace=".NET CLR LocksandThreads(Varonis.DbAdapter.WindowsService)">
		<Tags><add name="Name" value="Name"/></Tags>
		<Values>
		   <add name="num_current_physical_threads" value="# of current physical Threads"/>
		   <add name="contention_rate_sec" value="Contention Rate / sec"/>
		   <add name="current_queue_length" value="Current Queue Length"/>
		</Values>
		</add>
		
		<add name="perfmon_net_memory_DBAdapter" type="raw" filter="" resource="." namespace=".NET CLR Memory(Varonis.DbAdapter.WindowsService)">
		<Tags><add name="Name" value="Name"/></Tags>
		<Values>
		   <add name="precent_time_in_gc" value="% Time in GC"/>
		   <add name="num_pinned_objects" value="# of Pinned Objects"/>
		   <add name="num_gen_2_collections" value="# Gen 2 Collections"/>
		   <add name="num_gen_1_collections" value="# Gen 1 Collections"/>
		   <add name="num_gen_0_collections" value="# Gen 0 Collections"/>
		   <add name="num_bytes_in_all_heaps" value="# Bytes in all Heaps"/>
		   <add name="large_object_heap_size" value="Large Object Heap size"/>
		</Values>
		</add>
				
		<add name="perfmon_varonis_DBAdapter_v3" type="raw" filter="" resource="." namespace="Varonis DbAdapter Consumer.8.6.4(dbadapter consumer instance name)">
		<Tags><add name="Name" value="Name"/></Tags>
		<Values>
		   <add name="eventsPerSec_consumed" value="Consume Rate (Thread 1)"/>
		</Values>
		</add>

		<add name="perfmon_varonis_sqlextractor" type="raw" filter="" resource="." namespace="Varonis Sql Extractor">
		<Tags><add name="Name" value="Name"/></Tags>
		<Values>
		   <add name="total_bataches" value="# Batches"/>
		   <add name="total_failed_batches" value="# Failed Batches"/>
		   <add name="total_created_files" value="# Files"/>
		   <add name="total_retries" value="# Retries"/>
		   <add name="total_rows_reads_from_db_to_files" value="# Rows"/>
		   <add name="num_parallel_extractors" value="# Working Extractors"/>
		   <add name="total_elapsed_time" value="Elapsed Time - Total"/>
		   <add name="rowsPerSec_read_fromDB_bySingleExtractor" value="Single Batch DB Reads rows/sec - Total"/>
		   <add name="rowsPerSec_readAndWrite_fromDBtoFile_by_single_extractor" value="Single Batch Wtites rows/sec - Total"/>
		   <add name="rowsPerSec_readAndWrite_fromDBtoFile" value="Writes rows/sec - Current"/>
		   <add name="rowsPerSec_readAndWrite_fromDBtoFile_lastHour" value="Writes rows/sec - Last Hour"/>
		   <add name="rowsPerSec_readAndWrite_fromDBtoFile_fromTheProcessBeginning" value="Writes rows/sec - Total"/>
		</Values>
		</add>
		
		<add name="perfmon_varonis_solrloader" type="raw" filter="" resource="." namespace="Varonis Solr Loader">
		<Tags><add name="Name" value="Name"/></Tags>
		<Values>
		   <add name="total_documents_loaded_to_solr" value="Documents Loaded To Solr - Total"/>
		</Values>
		</add>
    </Queries>
  </Sonar>
 </configuration>


















